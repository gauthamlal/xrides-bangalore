(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{243:function(e,t,a){e.exports=a(419)},248:function(e,t,a){},253:function(e,t,a){},258:function(e,t){},260:function(e,t){},410:function(e,t){},411:function(e,t){},412:function(e,t){},419:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),l=a(66),i=a.n(l),o=(a(248),a(38)),c=(a(253),a(254),a(61)),u=a(189),s=a(12),m={rideList:[],isFileUploaded:!1,fileError:null},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FILE_UPLOAD":return Object(s.a)({},e,{rideList:t.payload.rideList,isFileUploaded:t.payload.isFileUploaded,fileError:t.payload.fileError,fileName:t.payload.fileError?null:t.payload.fileName});case"FILE_REMOVAL":return Object(s.a)({},e,{rideList:[],isFileUploaded:!1,fileError:null,fileName:null});default:return e}},p={selectedHour:null,highlightedHour:null,highlightedMode:null},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FILE_REMOVAL":return p;case"CHART_HIGHLIGHT":return Object(s.a)({},e,{highlightedHour:t.payload});case"CHART_SELECT":return Object(s.a)({},e,{selectedHour:t.payload});case"MODE_HIGHLIGHT":return Object(s.a)({},e,{highlightedMode:t.payload});default:return e}},g=Object(c.c)({data:d,chart:h}),f=[u.a],b=Object(c.e)(g,Object(c.d)(c.a.apply(void 0,f),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),E=a(3),v=a(4),y=a(6),O=a(5),k=a(7),j=a(208),N=a(191),_=a.n(N),x=function(e){return new Promise(function(t,a){var n=[],r=new FileReader;r.onload=function(){_.a.parse(r.result,function(e,r){if(e)a({status:!1,err:e});else{var l=r.shift();n=r.map(function(e){var t={};return e.forEach(function(e,a){t[l[a]]="NULL"===e?null:e}),t.online_booking=Number(t.online_booking),t.mobile_site_booking=Number(t.mobile_site_booking),t}),t({status:!0,rideList:n})}})},r.readAsBinaryString(e)})},H=Object(o.b)(function(e){return{rideList:e.data.rideList,isFileUploaded:e.data.isFileUploaded,fileError:e.data.fileError,fileName:e.data.fileName}},{uploadFile:function(e){return function(t){x(e).then(function(a){var n={};n.rideList=a.rideList,n.isFileUploaded=!0,n.error=null,n.fileName=e.name,t({type:"FILE_UPLOAD",payload:n})}).catch(function(e){var a={rideList:[],isFileUploaded:!1,fileError:!0};t({type:"FILE_UPLOAD",payload:a})})}},removeFile:function(){return function(e){e({type:"FILE_REMOVAL"})}}})(function(e){var t=r.a.createElement("div",{className:"dropzone file-uploaded"},r.a.createElement("p",null,"File ",r.a.createElement("span",{className:"file-name"},'"',e.fileName,'"')," has been uploaded successfully!"),r.a.createElement("p",{className:"remove-file",onClick:function(){e.removeFile()}},"X")),a=r.a.createElement(j.a,{accept:".csv",onDrop:function(t){return function(t){var a=t[0];e.uploadFile(a)}(t)}},function(t){var a=t.getRootProps,n=t.getInputProps;return r.a.createElement("div",Object.assign({className:e.fileError?"dropzone file-error":"dropzone"},a()),r.a.createElement("input",n()),e.fileError?r.a.createElement("p",null,"Incorrect file type uploaded. Click to select the correct file."):r.a.createElement("p",null,"Click to select your"," ",r.a.createElement("span",{style:{fontWeight:"bold"}},".CSV")," file"))});return e.isFileUploaded?t:a}),w=a(9),L=a(426),S=a(424),D=a(427),I=a(33),C=function(e){var t=e.reduce(function(e,t){var a=t.from_date?new Date(t.from_date).getHours():null,n=t.to_date?new Date(t.to_date).getHours():null;if("number"===typeof a){var r=e.pickupObj[a]||0;e.pickupObj[a]=r+1}if("number"===typeof n){var l=e.dropoffObj[n]||0;e.dropoffObj[n]=l+1}return e},{pickupObj:{},dropoffObj:{}});return t.pickups=Object.entries(t.pickupObj).map(function(e){var t=Object(w.a)(e,2),a=t[0],n=t[1];return{hour:Number(a),x:Number(a)+.5,y:n}}),t.dropoffs=Object.entries(t.dropoffObj).map(function(e){var t=Object(w.a)(e,2),a=t[0],n=t[1];return{hour:Number(a),x:Number(a)+.5,y:n}}),t},F=Object(o.b)(function(e){return{rideList:e.data.rideList,highlightedHour:e.chart.highlightedHour,selectedHour:e.chart.selectedHour}},{chartHighlight:function(e){return function(t){t({type:"CHART_HIGHLIGHT",payload:e})}},chartSelect:function(e){return function(t){t({type:"CHART_SELECT",payload:e})}}})(function(e){var t=e.rideList,a=e.chartHighlight,n=e.highlightedHour,l=e.chartSelect,i=e.selectedHour,o=C(t).pickups;if(!o)return r.a.createElement("div",{className:"chart"});var c=t.length,u=o.map(function(e){return Object(s.a)({},e,{color:e.hour===i?"#19CDD7":e.hour===n?"#17B8BE":"#125C77"})});return r.a.createElement("div",{className:"chart"},r.a.createElement("h2",null,"Pickups by hour"),r.a.createElement("p",null,"As percentage of all trips"),r.a.createElement(I.h,{height:140,width:480,margin:{left:40,right:25,top:10,bottom:35}},r.a.createElement(I.g,{tickFormat:function(e){return e%24>=12?(e%12||12)+"PM":(e%12||12)+"AM"},tickSizeInner:0,tickValues:[0,6,12,18,24],style:{line:{stroke:"#ADDDE1"},ticks:{stroke:"#ADDDE1"},text:{stroke:"none",fill:"#6b6b76",fontWeight:600}}}),r.a.createElement(I.i,{tickFormat:function(e){return(e/c*100).toFixed(0)+"%"},style:{line:{stroke:"#ADDDE1"},ticks:{stroke:"#ADDDE1"},text:{stroke:"none",fill:"#6b6b76",fontWeight:600}}}),r.a.createElement(I.e,{colorType:"literal",data:u,onValueMouseOver:function(e){return a(e.hour)},onValueMouseOut:function(){return a(null)},onValueClick:function(e){return t=e.hour,void l(i===t?null:t);var t},style:{cursor:"pointer"}})))}),M=function(e){return e.reduce(function(e,t){return t.online_booking?(e[0].angle++,e[0].number=e[0].angle):t.mobile_site_booking?(e[1].angle++,e[1].number=e[1].angle):(e[2].angle++,e[2].number=e[2].angle),e},[{label:"Online Booking",type:"online_booking",angle:0,number:0},{label:"Mobile Site Booking",type:"mobile_site_booking",angle:0,number:0},{label:"Other Modes",type:"others",angle:0,number:0}])},T=Object(o.b)(function(e){return{rideList:e.data.rideList}},{modeHighlight:function(e){return function(t){t({type:"MODE_HIGHLIGHT",payload:e})}}})(function(e){var t=Object(n.useState)(!1),a=Object(w.a)(t,2),l=a[0],i=a[1],o=function(t){i(t),t?e.modeHighlight(t.type):e.modeHighlight(null)},c=M(e.rideList),u=e.rideList.length;return r.a.createElement("div",null,r.a.createElement(I.d,{data:c,width:250,height:250,innerRadius:50,radius:100,onValueMouseOver:function(e){return o(e)},onValueMouseOut:function(e){return o(!1)}},!1!==l&&r.a.createElement(I.a,{value:l},r.a.createElement("div",{style:{background:"black",color:"white",padding:"10px"}},r.a.createElement("h4",null,"Mode of Booking"),r.a.createElement("p",null,l.label),r.a.createElement("p",null,(l.number/u*100).toFixed(2)+"%")))))}),A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],R=function(e){var t=e.reduce(function(e,t){var a=t.from_date?new Date(t.from_date).getMonth():null;if("number"===typeof a){var n=e.monthObj[a]||0;e.monthObj[a]=n+1}return e},{monthObj:{}});return t.monthArr=Object.entries(t.monthObj).map(function(e){var t=Object(w.a)(e,2),a=t[0],n=t[1];return{x:A[a],y:n}}),t.monthArr},U=Object(o.b)(function(e){return{rideList:e.data.rideList}})(function(e){var t=Object(n.useState)(!1),a=Object(w.a)(t,2),l=a[0],i=a[1],o=e.rideList,c=R(o);return r.a.createElement("div",{className:"chart",onMouseOut:function(){return i(!1)}},r.a.createElement("h2",{style:{marginTop:"10px"}},"Trips per month"),r.a.createElement(I.h,{xType:"ordinal",height:140,width:500,margin:{left:45,right:25,top:30,bottom:25},animation:!1},r.a.createElement(I.b,null),r.a.createElement(I.f,null),r.a.createElement(I.g,{tickSizeInner:0}),r.a.createElement(I.i,null),r.a.createElement(I.c,{data:c,style:{stroke:"violet",strokeWidth:3},onNearestX:function(e){e.x!==l.x&&i(e)},onSeriesMouseOut:function(e){i(!1)}}),!1!==l&&r.a.createElement(I.a,{value:l},r.a.createElement("div",{style:{background:"black",color:"white",padding:"10px"}},r.a.createElement("h4",null,"Number of Booking"),r.a.createElement("p",null,l.x),r.a.createElement("p",null,l.y)))))}),V=function(){var e=Object(n.useState)("pickup"),t=Object(w.a)(e,2),a=t[0],l=t[1],i=function(e,t){var a=t.name;l(a)},o="";switch(a){case"pickup":o=r.a.createElement(F,null);break;case"medium":o=r.a.createElement(T,null);break;case"monthly":o=r.a.createElement(U,null);break;default:o=r.a.createElement(F,null)}return r.a.createElement("div",{className:"chart-report"},r.a.createElement(L.a,null,r.a.createElement(L.a.Column,{width:4},r.a.createElement(S.a,{fluid:!0,vertical:!0,tabular:!0},r.a.createElement(S.a.Item,{name:"pickup",active:"pickup"===a,style:"pickup"!==a?{color:"white"}:{},onClick:i},r.a.createElement("span",{className:"menu-item"},r.a.createElement("i",{className:"fas fa-car",style:{fontSize:"48px"}}),r.a.createElement("span",null,"Pickups"))),r.a.createElement(S.a.Item,{name:"medium",active:"medium"===a,style:"medium"!==a?{color:"white"}:{},onClick:i},r.a.createElement("span",{className:"menu-item"},r.a.createElement("i",{className:"fas fa-desktop",style:{fontSize:"48px"}}),r.a.createElement("span",null,"Device"))),r.a.createElement(S.a.Item,{name:"monthly",active:"monthly"===a,onClick:i,style:"monthly"!==a?{color:"white"}:{}},r.a.createElement("span",{className:"menu-item"},r.a.createElement("i",{className:"fas fa-calendar",style:{fontSize:"48px"}}),r.a.createElement("span",null,"Monthly"))))),r.a.createElement(L.a.Column,{stretched:!0,width:12},r.a.createElement(D.a,null,r.a.createElement("div",{className:"chart-container"},o)))))},P=a(1),z=a(207),B=a(88),W=[[255,255,204],[199,233,180],[127,205,187],[65,182,196],[44,127,184],[37,52,148]],G={lightsPosition:[-73.8,40.5,8e3,-74.2,40.9,8e3],ambientRatio:.4,diffuseRatio:.6,specularRatio:.2,lightsStrength:[.8,0,.8,0],numberOfLights:2},X=[0,1e3];function J(e){var t=e.data,a=e.hour,n=e.mode,r=e.onHover,l=e.settings,i=null===a?t:t.filter(function(e){return e.hour===a});return i=null===n?i:i.filter(function(e){return e.mode===n}),[l.showScatterplot&&new B.b(Object(s.a)({id:"scatterplot",getPosition:function(e){return e.position},getFillColor:function(e){return e.pickup?[0,102,0]:[204,0,0]},getRadius:function(e){return 5},opacity:.5,pickable:!0,radiusMinPixels:.25,radiusMaxPixels:30,data:i,onHover:r},l,{visible:l.showScatterplot})),l.showHexagon&&new B.a(Object(s.a)({id:"hexagon-layer",colorRange:W,elevationRange:X,elevationScale:5,extruded:!0,getPosition:function(e){return e.position},lightSettings:G,opacity:.8,pickable:!0,data:i,onHover:r},l,{visible:l.showHexagon}))]}var Z=[{label:"Streets V10",value:"mapbox://styles/mapbox/streets-v10"},{label:"Outdoors V10",value:"mapbox://styles/mapbox/outdoors-v10"},{label:"Light V9",value:"mapbox://styles/mapbox/light-v9"},{label:"Dark V9",value:"mapbox://styles/mapbox/dark-v9"},{label:"Satellite V9",value:"mapbox://styles/mapbox/satellite-v9"}],$={showHexagon:{name:"Show Hexagon",displayName:"Hexagon",type:"boolean",value:!0,heading:!0},radius:{name:"Hexagon Radius",displayName:"Radius",type:"range",value:300,step:50,min:50,max:1e3,heading:!1},coverage:{name:"Hexagon Coverage",displayName:"Coverage",type:"range",value:1,step:.1,min:0,max:1,heading:!1},upperPercentile:{name:"Hexagon Upper Percentile",displayName:"Upper Percentile",type:"range",value:100,step:.1,min:80,max:100,heading:!1},showScatterplot:{name:"Scatterplot",displayName:"Scatterplot",type:"boolean",value:!0,heading:!0},radiusScale:{name:"Scatterplot Radius",displayName:"Radius",type:"range",value:20,step:5,min:1,max:200,heading:!1}},q=function(e){var t=e.style,a=e.changeMapStyle;return r.a.createElement("select",{className:"map-style-picker",value:t,onChange:function(e){return a(e.target.value)}},Z.map(function(e){return r.a.createElement("option",{key:e.label,value:e.value},e.label)}))},K=a(425),Q=function(e){var t=e.plopType;if(t&&t.type)switch(t.type){case"range":return r.a.createElement(ee,e);case"boolean":return r.a.createElement(Y,e);default:return r.a.createElement("input",e)}},Y=function(e){var t=e.settingName,a=e.value,n=e.onChange;return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"input-group"},r.a.createElement(K.a,{toggle:!0,id:t,checked:a,onChange:function(e){return n(t,e.target.checked)}})))},ee=function(e){var t=e.settingName,a=e.value,n=e.plopType,l=e.onChange,i=n.max,o=void 0===i?100:i;return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"input-group"},r.a.createElement("div",null,r.a.createElement("input",{type:"range",id:t,min:0,max:o,step:o/100,value:a,onChange:function(e){return l(t,Number(e.target.value))}}))))},te=function(e){var t=function(t,a){if(e.settings[t]!==a){var n=Object(s.a)({},e.settings,Object(P.a)({},t,a));e.handleLayerSettings(n)}},a=e.showSettings,n=e.toggleSettings,l=e.settings,i=e.plotTypes,o=void 0===i?{}:i;return a?r.a.createElement("div",{className:"layer-controls"},r.a.createElement("div",{className:"controls-toggle__holder"},r.a.createElement("i",{className:"controls-toggle fas fa-times",onClick:n})),Object.keys(l).map(function(e){return r.a.createElement("div",{key:e,style:o[e].heading?{display:"flex",justifyContent:"space-between",alignItems:"center"}:{}},r.a.createElement("label",{style:o[e].heading?{fontWeight:"bold",fontSize:"14px"}:{}},o[e].displayName),r.a.createElement("div",{style:{display:"inline-block",float:"right"}},l[e]),r.a.createElement(Q,{settingName:e,value:l[e],plopType:o[e],onChange:t}))})):r.a.createElement("div",{className:"layer-controls controls-toggle__holder"},r.a.createElement("i",{className:"controls-toggle fas fa-cog",onClick:n}))},ae=function(e){return e.reduce(function(e,t){var a=t.from_date?new Date(t.from_date).getHours():null,n=t.to_date?new Date(t.to_date).getHours():null,r=t.online_booking?"online_booking":t.mobile_site_booking?"mobile_site_booking":"others";return t.from_long&&e.push({position:[Number(t.from_long),Number(t.from_lat)],hour:a,pickup:!0,mode:r}),t.to_long&&e.push({position:[Number(t.to_long),Number(t.to_lat)],hour:n,pickup:!1,mode:r}),e},[])},ne={INITIAL_VIEW_STATE:{longitude:77.63817,latitude:13.00198,zoom:11,minZoom:5,maxZoom:16,pitch:0,bearing:0},style:"mapbox://styles/mapbox/light-v9",points:[],hover:{x:0,y:0,hoveredObject:null},settings:Object.keys($).reduce(function(e,t){return Object(s.a)({},e,Object(P.a)({},t,$[t].value))},{}),showSettings:!1},re=Object(o.b)(function(e){return{rideList:e.data.rideList,highlightedHour:e.chart.highlightedHour,selectedHour:e.chart.selectedHour,highlightedMode:e.chart.highlightedMode}})(function(e){var t=Object(n.useState)(ne),a=Object(w.a)(t,2),l=a[0],i=a[1];Object(n.useEffect)(function(){var t=ae(e.rideList);i(function(e){return Object(s.a)({},e,{points:t})})},[e.rideList]);return r.a.createElement("div",{className:"map-container"},l.hover.hoveredObject&&r.a.createElement("div",{className:"tooltip",style:{transform:"translate(".concat(l.hover.x,"px, ").concat(l.hover.y,"px)")}},r.a.createElement("div",null,l.hover.label)),r.a.createElement(q,{style:l.style,changeMapStyle:function(e){i(function(t){return Object(s.a)({},t,{style:e})})}}),r.a.createElement(te,{showSettings:l.showSettings,toggleSettings:function(){i(function(e){return Object(s.a)({},e,{showSettings:!e.showSettings})})},plotTypes:$,settings:l.settings,handleLayerSettings:function(e){i(function(t){return Object(s.a)({},t,{settings:e})})}}),r.a.createElement(B.c,{layers:J({data:l.points,hour:"number"===typeof e.highlightedHour?e.highlightedHour:e.selectedHour,settings:l.settings,mode:e.highlightedMode,onHover:function(e){return function(e){var t=e.x,a=e.y,n=e.object,r={x:t,y:a,hoveredObject:n,label:n?n.points?"".concat(n.points.length," pickups or dropoffs here"):n.pickup?"Pickup":"Dropoff":null};i(function(e){return Object(s.a)({},e,{hover:r})})}(e)}}),initialViewState:l.INITIAL_VIEW_STATE,controller:!0},r.a.createElement(z.a,{mapStyle:l.style})))}),le=function(e){function t(){return Object(E.a)(this,t),Object(y.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"dashboard"},r.a.createElement(H,null),r.a.createElement(re,null),this.props.isFileUploaded?r.a.createElement(V,Object.assign({},this.state,{highlight:function(t){return e.handleHighlight(t)},select:function(t){return e.handleChartSelect(t)}})):"")}}]),t}(n.Component),ie=Object(o.b)(function(e){return{rideList:e.data.rideList,isFileUploaded:e.data.isFileUploaded}})(le);function oe(){return r.a.createElement("div",{className:"navbar"},r.a.createElement("h2",null,"X-RIDES"),r.a.createElement("div",{className:"left"},r.a.createElement("img",{src:"/logo.png",alt:"logo"})))}var ce=function(){return r.a.createElement(o.a,{store:b},r.a.createElement("div",{className:"App"},r.a.createElement(oe,null),r.a.createElement(ie,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(ce,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[243,1,2]]]);
//# sourceMappingURL=main.677f987f.chunk.js.map